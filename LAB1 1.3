/*
  Exercise 1.3 â€“ Basic Calculator using Serial Input
  Board: Arduino MKR WiFi 1010
*/

void setup() {
  Serial.begin(9600);        // Start Serial communication
  while (!Serial);           // Wait for Serial Monitor to open
  Serial.println("=== Simple Calculator Started ===");
  Serial.println("Enter an operation like: 8 + 5 or 10 / 2");
  Serial.println("-------------------------------------");
}

void loop() {
  // A) Ask user for input
  Serial.print("Enter operation: ");

  // Wait until user types something
  while (Serial.available() == 0) {
    // Do nothing until data is received
  }

  // B) Read the full line (until Enter key)
  String input = Serial.readStringUntil('\n');
  input.trim();  // Remove any spaces/newlines at start or end

  // Variables to hold the parsed values
  float num1, num2;
  char op;

  // C) Parse the input: number operator number (e.g., 8 + 5)
  if (sscanf(input.c_str(), "%f %c %f", &num1, &op, &num2) == 3) {
    float result;
    bool valid = true;

    // D) Perform the chosen operation
    switch (op) {
      case '+': result = num1 + num2; break;
      case '-': result = num1 - num2; break;
      case '*': result = num1 * num2; break;
      case '/':
        if (num2 != 0) result = num1 / num2;
        else {
          Serial.println("Error: Division by zero!");
          valid = false;
        }
        break;
      default:
        Serial.println("Error: Invalid operator! Use +, -, *, or /");
        valid = false;
        break;
    }

    // E) Display the result
    if (valid) {
      Serial.print("Result: ");
      Serial.println(result, 4); // Print with 4 decimal precision
    }
  } 
  else {
    Serial.println("Invalid input! Use format: number operator number (e.g., 8 + 3)");
  }

  Serial.println("-------------------------------------");
  delay(500);  // Small pause before next prompt
}
